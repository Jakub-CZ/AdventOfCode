map_lines = """
...........
.....###.#.
.###.##..#.
..#.#...#..
....#.#....
.##..S####.
.##..#...#.
.......##..
.##.#.####.
.##..##.##.
...........
""".strip().splitlines(False)
map_linesx = """
...................................................................................................................................
................#.##....#......#.........#.....#.........................#......................#....#................#............
....#....#..#....#..#..##.#.............#.....#...##......................#............................##.......#........#.........
.#......................................#........#.....#..............................................#...................#..#.....
...###.#.....#...................#..........................................#..##.......#..#...................#...................
.....................#.#...........##.....#........#...#......................###...........................#......................
...............#..................#...........#....#...............................#.....#...............................#.........
......#..........#.##....#.......#.#....................................................................###......#....#............
...........#....#..............#....................#....................................#......#.......#..........#.........#...#.
....##.........##..#.........#...............#....................#...............#.....#.##.....#............#.....#.#............
...#..#..........#............#.....#....#...##...#....................#.............#.....#.....#...#...................#.........
....#.............#.....#...#...#...........##.................#..................#.#...........#...........##.........#...........
......#............................#..........................................................#...#......#..#...........#..........
...........................#...........#.............................................#.....#..#...........#......................#.
.#..#...#..##.##............#...##..............................#....................#................#.............#....#.........
......................#...........#....................#..............................#..................#.......#.................
...........#.......#................#.....#.#.............#.#......#.................................##..#......................#..
...............#......#....................#...........#..................................#.....#..#............#.......#.#....#...
..#...........#.#.......................................#...#........#..#................#..............#..#.#.......#........#....
......................#...#..........................................................................#........#....................
.............#.............##...#...........................#..#....#.....................#..#.......#...........#.................
.#....................#......#.....#....#.......#.............#...##..............#........#.#....#..#..............#......#..#....
....#.......#...............##.................#.................................................#........#....#....#..............
.#.............#....#..........................#................................................#.............#.##.................
..#........................#...........................................#............#........#.........#..#.................#......
......................#.............#...............#.........#........##......#.#.......................#.........#...#...........
..#...........#..............#..............#...........#......#.........#...#.....#.......................#...#.#.................
...##..#.........#...............#....................#..#..#..#.....#..............#...#..............#.#...#......#.#............
.......................#.............................#....#...#............#..#...................................#..............#.
.#...#.##..........#..##.#.......................#........#.....#...................................#.#...........#....#..##....#..
..............#.#....#.......#...........#.........#......#....................#......##............#..............................
..............#..........#............#..........#.....#....#.............................#.#.......#.....#.....#..........#.......
..#.....#....#..........#.....................##..#....##..#..##......#....................................#..................#....
...................#..#...............##...............#.#....#..................##.......................#........#...........#...
....#...#..................#................................#......#...#.....#...........#................................#........
....................................#...........#..#......##.......#..#.................#..#.......................................
............#....#....#............#.#.................#........................#...............#............#..............#......
................................#............#..................#.##.....#.....................#............###...........#...#.#..
.............#.........#.........#.................#..................##....#..........#..#..............................#.#.......
..........................................#................#........#..........#............#...........................#....##..#.
.#...#...#.....##...........................#.............#..............................#..#.................#..#....#.........##.
............#...............#.....#..#.....#.................#........#..#.......#........#...##.#...............#.......#..#...#..
..#.#.#.........#..........#............#..##....#......###........#.#......#....#..#.....#.......#........................#.......
.............#....................#.#.#.............#...#.#.....#..#....#.#...#....#....#.......#.#....................#...#.......
......##..................#............#....................#...................#....#.........#.#.........................#..#....
............#.##.........#...............#...........................#..............#.#............................#...............
........#....#...............#.....#..#......#...##....#............#.....#.........##.....................#..................#....
.................................##....#..#.#.......#........#.................#.#.........................#...........#.#.#.......
........................#....#............................#..#.....#.....#.#...........................................#...........
.#.......#...........#....#......................#.........#......#...#...#.......#.#..........##.....#................#...........
......#...........................#......#.#.......#.......#.#........................#..................#..............#..........
........#.........#........#..#...................#...#...#...#......#.#................##.#......#.......#...............#..#..##.
.......#........................#..........##.........#...##..............#.....#.....#............................................
.......#................#....##.......................#..#..................#....................#.............#.............#.....
............................#...#...#........##........##..........#.......#..............#......................................#.
......#............................................#.........#......#....................#.....#.##.#.............#................
...............#...........##......#..........................#...........#..............................#.#....#.#..........#..#..
........................##..................................................#.......................#........#.....#...............
....................#..............#..............#.............#.......#..........................#.............#.................
.................#..#.#.#......#.........#.....#...........#.......#..........#...........#........................................
.................................................#.............................................#..........#....#..##...#.........#.
...................#....#.................#.......#...#............#....................#.............#...............#............
.........#....#......#......#...#...#.......#.......#..#.............#....#.....#..............#....#...................#..........
.........#..#..............................#....#.......#.......#....#.....#...#...#...#...........#.....##...............#........
.....#..................#....#........#............##.#....#..............#...#.#.....#...........#.#......#....#..................
.................................................................S.................................................................
.......#...........#.#.........#...#........#.#......#.......##.#......##...........................#...#.....#.........#..........
..................................................#............................#..........#................###......##..#..........
........#....#.......................#.##...#......#...........#..............#......#............#................................
.........................#...........................#.................#....#..#................#....................#.............
...................#..................#.........................#........##....#.................##..#..#.......##.....#...........
...............................#..#........#.#........#..............#............#..##...#.#.......#..............................
...............#.............#...#.....#.........#..##............................#..............#.#........#..#...#...............
..#.........#................#.......##...............#...............#........#......#.......#...........##...#.#..#...........#..
.............#............#....##..#.#......##...##..#................................#..#.....##....#........................#....
..............#.....#...#.....#...................#.......##.#.......#..#..............................#.....#.....................
........................#......#...#......#.....#...........#.#...#...................#........#..........#..#.....................
...................#..................#.......#......................................##......#...#..#........##....................
.....................#......................#.........#.#.#.............#.....#...........#...#..........#.........................
.........................#.#...#..........#....##.............................#........#......#...#.........#......................
.#......#.#...............#.#.#.#.............#...#...#...............##..#...........#...#..........#.#.#...#...................#.
........#.###...........#..#..........##.....#.#.........#.#..#..............#..............#..........................#.....#.....
......#........................................#......#.........#...#..............................#.....................#.....##..
....#...#.....................#....#..........#.........................#....#.#..........#..#...#..................#.......#......
...#......#..............#.....................#..........................#...........#.....#....#...#.............................
........#.......#.........#................#...........#......##......................................#...................#.##.....
..#..#..#...................#..................#.........#...#......#............#..#.#.#.........#..#.............................
.........##..##...........................#.........#.....................#.......#.#...#...#.......#................#.#...........
.....#.......#..............#...#..................#.................................#..#..#......#...#..............#........#....
............................#.............#.................................#..#..#...#................................#..#........
........#.#....#.............#.#............#..............##.......###............................#..........#..........#.........
.......#...#....................#....#.#....#...#.#.#...##.........................#..........................................#....
..#......................................................###.........................#...............................#.##..........
......#........#...#..............#......#...............#...##.#...#.........#.........#.........#...................##...........
.........#.....#..................#............#.....#........#........#..................#.#.............#........#....#..........
...##...............#...#...........#..##...........#...#.#................##.......#....#.#....#...........#........#.#...........
......#.............#...................##..#................#................#..........#...#..........#.......#...........#......
.......#................................................#..............#..........#.#......#..#........#....#....#.#...#...........
....#.....#.........#...#....#.........................#..#.............##.....#.#...............................#.#.....#.........
.......................................#.....##.....#...#.#......................#..#................................#...........#.
......#..........##.#..........................................#.......##..#.........##........................#................#..
..............#.......#........................#.......#.#......#...............#.#.................#.............#..#.............
....................................................#...........#.....#......#.#.#................##....#...#.#.#.........#........
........#..................#.................................##.....................#...#............##.....#.#.........#...#...#..
.....#....#.#...#......#......#.........................#.#...............#..#.......................#...........#..##.........#.#.
..........#.................................#.....................#...#.#......#.....##...........#..............#.................
..##..##.....................#..................#.#......#.#.......#....#.#..........................#.#...#.........#...#.........
...................#.......#...#.....................................#...#........#....................#.............#.......#.....
............#..#..#...................................#......#..................#..........#..........##....................#......
...........##.........#...#.#.....#....#............##...#.............................................#..#.....#..........#.......
......#....#..............#.......#..................#...##...#.#.......#..........................#...#..............##...........
............#..##....#...........#..#....##...........#........................................#.....#..#..#........#..............
....................#.....#.#....#.........#.........#.......................................................#.........#....#......
.........#...#...................#........................#..................#................#............#.#.....................
.......................#.......#..........................#..#........................#.........#..................#....#..........
...#.#.................................#..#...................#......#.....#.......................#......#.......#.........#......
...#............#.....#...#.....#.....#.#................#....#....#.#...#................#...............#...............#....#...
...............................#.........................####.#...#...#...............................#.........................##.
.....#.................#..#..##.....#...#....................##....................#.#........#................#.#...........#.....
.#.............#..#.........#.###.#...........#............#....................#........................#......#....###..#........
......#.......#..#.........#......................##..............................#...................#.......#......#....#........
....#.....#.......................#.........#.....................#................#..............#....................#......#....
......#............#...#...#....#.#.................#...............#...................#..........#.............#..#.#............
......................#............................#...................................#.#.#...#.#...#........#..........#....#..#.
......#......................#..............#.......#........................#.............##.#.#..................................
..................................#............##..........................#......#......#..#...............#......................
......#.........#..##.#...##......#............#..........................#.......#........#....##...#...#.........................
.#....................#.........#.........#.................................##...............##...........#............#...#.......
..#..................#.....#.......#..#.........#.....#..###..................#.......#....#.............##.#..#...................
.#.....#...#.#.............#.....#.....#..#.....#.........#...........#...#......#............#..#.#.......#......#................
...................................................................................................................................
""".strip().splitlines(False)
WIDTH = len(map_lines[0])
HEIGHT = len(map_lines)
start = next((x, y) for y, line in enumerate(map_lines) if (x := line.find("S")) >= 0)


# PART 1
def make_steps(n):
    positions = {start}
    for _ in range(n):
        new_positions = set()
        for x, y in positions:
            for dx, dy in [(1, 0), (0, 1), (-1, 0), (0, -1)]:
                nx, ny = x + dx, y + dy
                if 0 <= nx < WIDTH and 0 <= ny < HEIGHT and map_lines[ny][nx] != "#":
                    new_positions.add((nx, ny))
        positions = new_positions
    return positions


def print_map(positions):
    for row, line in enumerate(map_lines):
        new_line = list(line)
        for col in [x for (x, y) in positions if y == row]:
            new_line[col] = "O"
        print("".join(new_line))


# PART 2


if __name__ == '__main__':
    reachable_plots = make_steps(64)
    print(f"Reachable garden plots: {len(reachable_plots)}")
    # print_map(reachable_plots)
